---
title: "Milestone 2: Core results 01"
author: "Anders"
date: "25/1/2023"
output: pdf_document
#output: html_notebook
editor_options: 
  chunk_output_type: console
---

<!-- ```{r echo=FALSE}  -->
<!-- knitr::opts_chunk$set(echo=FALSE)  -->
<!-- ``` -->

```{r global-options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
                      echo=FALSE, warning=FALSE, message=FALSE)
```
# Data
Two clinical trails on breast cancer (advanced HR+/HER2- and HER2-E breast cancer) using two different drug combination
## Trail 1
Two treatments which differ with respect to drug combination 
- Target: ribociclib and endocrine therapy (letrozole)
- Chemotherapy: doxorubicin, cyclophosphamide and paclitaxel. 
approx. 50 patients in each group.
Endpoints: proliferation score, ROR score

## Trail 2
The primary objective of this study is to compare two cdk4/6 targeted drugs (Palbociclib, n=36; Abemaciclib, n=3 in combination with endocrine therapy (tamoxifen, fulvestrant or aromatase inhibitors,  I think?) 

Endpoints: progression free survival (months), OS?, and status of the two former (dont know what that means)

# Major goal
1. Find best model to predict outcome of cancer treatment with genetic profile as predictive features
2. Features selection in order to understand cancer biology

# Major challanges
Preliminary experiments (on trail 1) showed instability in prediction and feature selection between bootstrap samples og Lasso. I believe this is a classical problem of high-dim data?

# Approch
Test all thinkable models to see if some is surperior

# Evaluation of models
Two levels of evaluation is scheduled:

## 1. Comparison of models
1000 bootstrap models are fitted and then evaluated on the original sample. This gives a relative comparison of the various models with respect to data similar to the given data set. In addition to Correlation and MSE, frequency of selected features is compared.

## 2. Expected outcome of future patients
3 strategies are considered:  
1. Repeated cross-validations (100 rep) \
2. Bootstrap models with 0.632 (or 0.632?) adjustment \
3. Test data set from a second trail (This trail have different responses) \

# Models
## Lasso
## Post Lasso
## Ridge
## Elastic Net
## Boosting with stumps as base learner
### - mboost
### - xgboost
## Feature selecting ensemble model


# RESULTS

# Lasso
```{r include=TRUE}
load("/Users/anders/Documents/MASTER/Cancer/R_codeP01/lb_object_AllGenes01.RData")

# Correlation
cor_vec <- as.numeric(lb_object[[1]])
sum(is.na(cor_vec))/length(cor_vec)    # fraction of NA
mean(cor_vec, na.rm=TRUE)
median(cor_vec, na.rm=TRUE)
var(cor_vec, na.rm=TRUE)
# par(mfrow=c(1,1))
hist(cor_vec, breaks = 100)

```







# Post Lasso
# Ridge
# Elastic Net
# Boosting with stumps as base learner




